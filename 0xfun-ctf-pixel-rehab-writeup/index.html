<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
        <meta property="og:title" content="0xFUN CTF - Pixel Rehab Writeup" />
        <meta property="twitter:title" content="0xFUN CTF - Pixel Rehab Writeup" />
        <meta property="og:description" content="My writeup for the Pixel Rehab challenge of 0xFUN CTF 2026." />
        <meta property="og:description" content="My writeup for the Pixel Rehab challenge of 0xFUN CTF 2026." />
        <meta property="twitter:image" content="https://mdgaziur.github.io/blog/0xfun-ctf-pixel-rehab-writeup/social_banner.png" />
        <meta property="og:image" content="https://mdgaziur.github.io/blog/0xfun-ctf-pixel-rehab-writeup/social_banner.png" />
    

    <title>0xFUN CTF - Pixel Rehab Writeup | mdgaziur001/blog</title>

    <link rel="stylesheet" href="https://mdgaziur.github.io/blog/main.css" />

    <!-- Inter font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" rel="stylesheet">

    <!-- JetBrains Mono font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap" rel="stylesheet">

    <!-- KaTeX Setup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.28/dist/katex.min.css" integrity="sha384-Wsr4Nh3yrvMf2KCebJchRJoVo1gTU6kcP05uRSh5NV3sj9+a8IomuJoQzf3sMq4T" crossorigin="anonymous">

    <!-- The loading of KaTeX is deferred to speed up page rendering -->
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.28/dist/katex.min.js" integrity="sha384-+W9OcrYK2/bD7BmUAk+xeFAyKp0QjyRQUCxeU31dfyTt/FrPsUgaBTLLkVf33qWt" crossorigin="anonymous"></script>

    <!-- To automatically render math in text elements, include the auto-render extension: -->
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.28/dist/contrib/auto-render.min.js" integrity="sha384-hCXGrW6PitJEwbkoStFjeJxv+fSOOQKOPbJxSfM6G5sWZjAyWhXiTIIAmQqnlLlh" crossorigin="anonymous"
            onload="renderMathInElement(document.body);"></script>
</head>
<body>
    <div class="main-container">
        <nav class="main-nav">
            <h1>
                <a style="color: white;" href="/">mdgaziur001</a>
                /
                <a style="color: white;" href="/blog">blog</a>
            </h1>
            <p>My ramblings about tech, life and other stuff.</p>
        </nav>
        
<main class="post-container">
    <article class="post">
        <header>
            <h1>0xFUN CTF - Pixel Rehab Writeup</h1>
            <p>3 minute reading time</p>
            <p>Posted at: February 22, 2026 •  2:06 AM</p>
        </header>
        <div class="post-content">
            <p>Assalamu Alaikum, welcome to my writeup for the Pixel Rehab challenge of 0xFUN CTF 2026! This is an interesting challenge from the
forensics category. The difficulty level is hard. Here's the challenge description:</p>
<blockquote>
<p>Our design intern “repaired” a broken image and handed us the result,
claiming the important part is still in there. All we know is the original
came from a compressed archive, and something about the recovery feels suspicious.
You’re given one file. It looks like an image problem. It behaves like an image
problem. Find what was actually archived and submit the flag in the format <code>0xfun{...}</code>.</p>
</blockquote>
<p>We are given a file called <a href="https://mdgaziur.github.io/blog/0xfun-ctf-pixel-rehab-writeup/./pixel.fun"><code>pixel.fun</code></a>. Running <code>exiftool</code> on it gives the following output:</p>
<pre class="giallo" style="color: #DCD7BA; background-color: #1F1F28;"><code data-lang="shellscript"><span class="giallo-l"><span style="color: #7AA89F;">❯</span><span style="color: #98BB6C;"> exiftool pixel.fun</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">ExifTool</span><span style="color: #98BB6C;"> Version Number         :</span><span style="color: #D27E99;"> 13.44</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">File</span><span style="color: #98BB6C;"> Name                       : pixel.fun</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">Directory</span><span style="color: #98BB6C;">                       : .</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">File</span><span style="color: #98BB6C;"> Size                       :</span><span style="color: #D27E99;"> 637</span><span style="color: #98BB6C;"> kB</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">File</span><span style="color: #98BB6C;"> Modification Date/Time     : 2026:02:22 08:01:37+06:00</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">File</span><span style="color: #98BB6C;"> Access Date/Time           : 2026:02:22 08:01:37+06:00</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">File</span><span style="color: #98BB6C;"> Inode Change Date/Time     : 2026:02:22 08:01:37+06:00</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">File</span><span style="color: #98BB6C;"> Permissions                : -rw-r--r--</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">Error</span><span style="color: #98BB6C;">                           : Unknown file type</span></span></code></pre>
<p>Nothing interesting here... Let's try <code>hexdump -C</code>:</p>
<pre class="giallo" style="color: #DCD7BA; background-color: #1F1F28;"><code data-lang="shellscript"><span class="giallo-l"><span style="color: #7AA89F;">00000000</span><span style="color: #D27E99;">  88 50</span><span style="color: #98BB6C;"> 4e</span><span style="color: #D27E99;"> 47</span><span style="color: #98BB6C;"> 0d 0a 1a 0a</span><span style="color: #D27E99;">  00 00 00</span><span style="color: #98BB6C;"> 0d</span><span style="color: #D27E99;"> 49 48 44 52</span><span style="color: #E6C384;">  |</span><span style="color: #7AA89F;">.PNG........IHDR</span><span style="color: #E6C384;">|</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">00000010</span><span style="color: #D27E99;">  00 00 03</span><span style="color: #98BB6C;"> e8</span><span style="color: #D27E99;"> 00 00 02</span><span style="color: #98BB6C;"> 8a</span><span style="color: #D27E99;">  08 02 00 00 00 21</span><span style="color: #98BB6C;"> 8a e6</span><span style="color: #E6C384;">  |</span><span style="color: #7E9CD8;">.............</span><span style="color: #98BB6C;">!</span><span style="color: #7E9CD8;">..</span><span style="color: #E6C384;">|</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">00000020</span><span style="color: #D27E99;">  56 00 01 00 00 49 44 41  54 78</span><span style="color: #98BB6C;"> 9c ec dd</span><span style="color: #D27E99;"> 75</span><span style="color: #98BB6C;"> 5c</span><span style="color: #D27E99;"> 93</span><span style="color: #E6C384;">  |</span><span style="color: #7AA89F;">V....IDATx...u\.</span><span style="color: #E6C384;">|</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">00000030</span><span style="color: #98BB6C;">  eb ff 3f f0 6b 8c</span><span style="color: #D27E99;"> 46</span><span style="color: #98BB6C;"> a4</span><span style="color: #D27E99;">  51 40 90 12</span><span style="color: #98BB6C;"> a4</span><span style="color: #D27E99;"> 14 03 03</span><span style="color: #E6C384;">  |</span><span style="color: #7E9CD8;">..</span><span style="color: #98BB6C;">?.k.F.Q@</span><span style="color: #7E9CD8;">......</span><span style="color: #E6C384;">|</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">00000040</span><span style="color: #D27E99;">  05</span><span style="color: #98BB6C;"> c5 c2</span><span style="color: #D27E99;"> 16</span><span style="color: #98BB6C;"> 8f a8 d8 9d  c7 ae</span><span style="color: #D27E99;"> 63 77</span><span style="color: #98BB6C;"> 7b 8c</span><span style="color: #D27E99;"> 63 77</span><span style="color: #E6C384;">  |</span><span style="color: #7E9CD8;">.........</span><span style="color: #98BB6C;">.cw{.cw</span><span style="color: #E6C384;">|</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">00000050</span><span style="color: #D27E99;">  77 17</span><span style="color: #98BB6C;"> a2 a0</span><span style="color: #D27E99;"> 22 76 81 05  22 12</span><span style="color: #98BB6C;"> 4a</span><span style="color: #D27E99;"> 83 74</span><span style="color: #98BB6C;"> c7</span><span style="color: #D27E99;"> 18</span><span style="color: #98BB6C;"> fb</span><span style="color: #E6C384;">  |</span><span style="color: #7AA89F;">w...&quot;v..&quot;.J.t...</span><span style="color: #E6C384;">|</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">00000060</span><span style="color: #98BB6C;">  fd</span><span style="color: #D27E99;"> 71</span><span style="color: #98BB6C;"> 7f 3f fb cd dd</span><span style="color: #D27E99;"> 63</span><span style="color: #98BB6C;">  6c</span><span style="color: #D27E99;"> 63 30 86</span><span style="color: #98BB6C;"> af e7 e3 3c</span><span style="color: #E6C384;">  |</span><span style="color: #7AA89F;">.q.?...clc0....</span><span>&lt;</span><span style="color: #E6C384;">|</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">00000070</span><span style="color: #98BB6C;">  ce</span><span style="color: #D27E99;"> 43</span><span style="color: #98BB6C;"> ae fb da</span><span style="color: #D27E99;"> 75</span><span style="color: #98BB6C;"> 5f</span><span style="color: #D27E99;"> 77</span><span style="color: #98BB6C;">  6c 7b ef ba af</span><span style="color: #D27E99;"> 60 14 14</span><span style="color: #E6C384;">  |</span><span style="color: #7AA89F;">.C...u_wl</span><span style="color: #98BB6C;">{</span><span style="color: #7E9CD8;">...</span><span style="color: #9CABCA;">`</span><span style="color: #7E9CD8;">..</span><span style="color: #E6C384;">|</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">00000080</span><span style="color: #D27E99;">  14 10 00 00 00 00 00</span><span style="color: #98BB6C;"> a8  dd</span><span style="color: #D27E99;"> 14 64</span><span style="color: #98BB6C;"> 5d</span><span style="color: #D27E99;"> 01 00 00 00</span><span style="color: #E6C384;">  |</span><span style="color: #7E9CD8;">.........</span><span style="color: #98BB6C;">.d]</span><span style="color: #7E9CD8;">....</span><span style="color: #E6C384;">|</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">00000090</span><span style="color: #D27E99;">  00 00</span><span style="color: #98BB6C;"> a8 1c</span><span style="color: #D27E99;"> 02 77 00 00  00 00 00 39 80</span><span style="color: #98BB6C;"> c0 1d</span><span style="color: #D27E99;"> 00</span><span style="color: #E6C384;">  |</span><span style="color: #7E9CD8;">....</span><span style="color: #98BB6C;">.w.</span><span style="color: #7E9CD8;">...</span><span style="color: #98BB6C;">.9.</span><span style="color: #7E9CD8;">...</span><span style="color: #E6C384;">|</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">000000a0</span><span style="color: #D27E99;">  00 00 00 40</span><span style="color: #98BB6C;"> 0e</span><span style="color: #D27E99;"> 20 70 07  00 00 00 00 90 03 08</span><span style="color: #98BB6C;"> dc</span><span style="color: #E6C384;">  |</span><span style="color: #7E9CD8;">...</span><span style="color: #98BB6C;">@</span><span style="color: #7E9CD8;">.</span><span style="color: #98BB6C;"> p.........</span><span style="color: #E6C384;">|</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">000000b0</span><span style="color: #D27E99;">  01 00 00 00 00</span><span style="color: #98BB6C;"> e4</span><span style="color: #D27E99;"> 00 02  77 00 00 00 00 00 39 80</span><span style="color: #E6C384;">  |</span><span style="color: #7E9CD8;">.......</span><span style="color: #98BB6C;">.w.</span><span style="color: #7E9CD8;">...</span><span style="color: #98BB6C;">.9.</span><span style="color: #E6C384;">|</span></span>
<span class="giallo-l"><span style="color: #9CABCA;">[</span><span style="color: #98BB6C;">omitted</span><span style="color: #9CABCA;">]</span></span></code></pre>
<p>The first 8 bytes are very similar to the PNG signature, which is <code>89 50 4e 47 0d 0a 1a 0a</code>. However, the first byte is
<code>88</code> instead of <code>89</code>. This is a very small difference, but it makes the file unreadable as a PNG image. So, let's
edit that byte and set it to <code>89</code>. After editing using <code>hexedit</code>, saving it as <code>pixel.png</code> and opening the file, we
get the following:</p>
<p><img src="https://mdgaziur.github.io/blog/0xfun-ctf-pixel-rehab-writeup/./pixel.png" alt="pixel.png" /></p>
<p>The flag here is a false flag which tells us that there's more to this. The gibberish pixels in this image hints towards
extra data embedded into this image. Let's run <code>pngcheck -v pixel.png</code> and check the output:</p>
<pre class="giallo" style="color: #DCD7BA; background-color: #1F1F28;"><code data-lang="shellscript"><span class="giallo-l"><span style="color: #7AA89F;">❯</span><span style="color: #98BB6C;"> pngcheck -v pixel.png</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">File:</span><span style="color: #98BB6C;"> pixel.png</span><span> (636966</span><span style="color: #98BB6C;"> bytes</span><span>)</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">  chunk</span><span style="color: #98BB6C;"> IHDR at offset 0x0000c, length</span><span style="color: #D27E99;"> 13</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">    1000</span><span style="color: #98BB6C;"> x</span><span style="color: #D27E99;"> 650</span><span style="color: #98BB6C;"> image, 24-bit RGB, non-interlaced</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">  chunk</span><span style="color: #98BB6C;"> IDAT at offset 0x00025, length</span><span style="color: #D27E99;"> 65536</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">    zlib:</span><span style="color: #98BB6C;"> deflated, 32K window, default compression</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">  chunk</span><span style="color: #98BB6C;"> IDAT at offset 0x10031, length</span><span style="color: #D27E99;"> 65536</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">  chunk</span><span style="color: #98BB6C;"> IDAT at offset 0x2003d, length</span><span style="color: #D27E99;"> 65536</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">  chunk</span><span style="color: #98BB6C;"> IDAT at offset 0x30049, length</span><span style="color: #D27E99;"> 65536</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">  chunk</span><span style="color: #98BB6C;"> IDAT at offset 0x40055, length</span><span style="color: #D27E99;"> 65536</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">  chunk</span><span style="color: #98BB6C;"> IDAT at offset 0x50061, length</span><span style="color: #D27E99;"> 65536</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">  chunk</span><span style="color: #98BB6C;"> IDAT at offset 0x6006d, length</span><span style="color: #D27E99;"> 65536</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">  chunk</span><span style="color: #98BB6C;"> IDAT at offset 0x70079, length</span><span style="color: #D27E99;"> 65536</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">  chunk</span><span style="color: #98BB6C;"> IDAT at offset 0x80085, length</span><span style="color: #D27E99;"> 65536</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">  chunk</span><span style="color: #98BB6C;"> IDAT at offset 0x90091, length</span><span style="color: #D27E99;"> 45789</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">  chunk</span><span style="color: #98BB6C;"> IEND at offset 0x9b37a, length</span><span style="color: #D27E99;"> 0</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">  additional</span><span style="color: #98BB6C;"> data after IEND chunk</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">ERRORS</span><span style="color: #98BB6C;"> DETECTED in pixel.png</span></span></code></pre>
<p>As expected, there's extra data after the image ends. Using the following script, we extract the trailing data:</p>
<pre class="giallo" style="color: #DCD7BA; background-color: #1F1F28;"><code data-lang="python"><span class="giallo-l"><span aria-hidden="true" class="giallo-ln" style="color: #54546D;"> 1</span><span style="color: #727169;"># extract_final.py</span></span>
<span class="giallo-l"><span aria-hidden="true" class="giallo-ln" style="color: #54546D;"> 2</span><span>filename</span><span style="color: #E6C384;"> =</span><span style="color: #98BB6C;"> &quot;pixel.png&quot;</span></span>
<span class="giallo-l"><span aria-hidden="true" class="giallo-ln" style="color: #54546D;"> 3</span><span>output_file</span><span style="color: #E6C384;"> =</span><span style="color: #98BB6C;"> &quot;hidden_data.bin&quot;</span></span>
<span class="giallo-l"><span aria-hidden="true" class="giallo-ln" style="color: #54546D;"> 4</span></span>
<span class="giallo-l"><span aria-hidden="true" class="giallo-ln" style="color: #54546D;"> 5</span><span style="color: #727169;"># Offset from pngcheck + 12 bytes for the IEND chunk itself</span></span>
<span class="giallo-l"><span aria-hidden="true" class="giallo-ln" style="color: #54546D;"> 6</span><span>iend_offset</span><span style="color: #E6C384;"> =</span><span style="color: #957FB8;"> 0x</span><span style="color: #D27E99;">9b37a</span></span>
<span class="giallo-l"><span aria-hidden="true" class="giallo-ln" style="color: #54546D;"> 7</span><span>start_of_hidden_data</span><span style="color: #E6C384;"> =</span><span> iend_offset</span><span style="color: #E6C384;"> +</span><span style="color: #D27E99;"> 12</span></span>
<span class="giallo-l"><span aria-hidden="true" class="giallo-ln" style="color: #54546D;"> 8</span></span>
<span class="giallo-l"><span aria-hidden="true" class="giallo-ln" style="color: #54546D;"> 9</span><span style="color: #957FB8;font-weight: bold;">with</span><span style="color: #7E9CD8;"> open</span><span style="color: #9CABCA;">(</span><span style="color: #7E9CD8;">filename</span><span style="color: #9CABCA;">,</span><span style="color: #98BB6C;"> &quot;rb&quot;</span><span style="color: #9CABCA;">)</span><span style="color: #957FB8;font-weight: bold;"> as</span><span> f</span><span style="color: #9CABCA;">:</span></span>
<span class="giallo-l"><span aria-hidden="true" class="giallo-ln" style="color: #54546D;">10</span><span>    f</span><span style="color: #9CABCA;">.</span><span style="color: #7E9CD8;">seek</span><span style="color: #9CABCA;">(</span><span style="color: #7E9CD8;">start_of_hidden_data</span><span style="color: #9CABCA;">)</span></span>
<span class="giallo-l"><span aria-hidden="true" class="giallo-ln" style="color: #54546D;">11</span><span>    hidden_data</span><span style="color: #E6C384;"> =</span><span> f</span><span style="color: #9CABCA;">.</span><span style="color: #7E9CD8;">read</span><span style="color: #9CABCA;">()</span></span>
<span class="giallo-l"><span aria-hidden="true" class="giallo-ln" style="color: #54546D;">12</span></span>
<span class="giallo-l"><span aria-hidden="true" class="giallo-ln" style="color: #54546D;">13</span><span style="color: #957FB8;font-weight: bold;">with</span><span style="color: #7E9CD8;"> open</span><span style="color: #9CABCA;">(</span><span style="color: #7E9CD8;">output_file</span><span style="color: #9CABCA;">,</span><span style="color: #98BB6C;"> &quot;wb&quot;</span><span style="color: #9CABCA;">)</span><span style="color: #957FB8;font-weight: bold;"> as</span><span> out</span><span style="color: #9CABCA;">:</span></span>
<span class="giallo-l"><span aria-hidden="true" class="giallo-ln" style="color: #54546D;">14</span><span>    out</span><span style="color: #9CABCA;">.</span><span style="color: #7E9CD8;">write</span><span style="color: #9CABCA;">(</span><span style="color: #7E9CD8;">hidden_data</span><span style="color: #9CABCA;">)</span></span>
<span class="giallo-l"><span aria-hidden="true" class="giallo-ln" style="color: #54546D;">15</span></span>
<span class="giallo-l"><span aria-hidden="true" class="giallo-ln" style="color: #54546D;">16</span><span style="color: #7E9CD8;">print</span><span style="color: #9CABCA;">(</span><span style="color: #957FB8;">f</span><span style="color: #98BB6C;">&quot;Extracted </span><span style="color: #FFA066;">{</span><span style="color: #7E9CD8;">len</span><span style="color: #9CABCA;">(</span><span style="color: #7E9CD8;">hidden_data</span><span style="color: #9CABCA;">)</span><span style="color: #FFA066;">}</span><span style="color: #98BB6C;"> bytes to </span><span style="color: #FFA066;">{</span><span style="color: #7E9CD8;">output_file</span><span style="color: #FFA066;">}</span><span style="color: #98BB6C;">&quot;</span><span style="color: #9CABCA;">)</span></span></code></pre>
<p>Running it gives the following output:</p>
<pre class="giallo" style="color: #DCD7BA; background-color: #1F1F28;"><code data-lang="shellscript"><span class="giallo-l"><span style="color: #7AA89F;">❯</span><span style="color: #98BB6C;"> python3 extract_final.py pixel.png</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">Extracted</span><span style="color: #D27E99;"> 1184</span><span style="color: #98BB6C;"> bytes to hidden_data.bin</span></span></code></pre>
<p>Let's open <code>hidden_data.bin</code> in hexdump:</p>
<pre class="giallo" style="color: #DCD7BA; background-color: #1F1F28;"><code data-lang="shellscript"><span class="giallo-l"><span style="color: #7AA89F;">00000000</span><span style="color: #98BB6C;">  0d 0a</span><span style="color: #D27E99;"> 00 04</span><span style="color: #98BB6C;"> cc ac</span><span style="color: #D27E99;"> 11 59  22 04 00 00 00 00 00 00</span><span style="color: #E6C384;">  |</span><span style="color: #7E9CD8;">......</span><span style="color: #98BB6C;">.Y</span><span style="color: #7AA89F;">&quot;.......|</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">00000010  62 00 00 00 00 00 00 00  6b 5e af 4d e0 05 03 04  |b.......k^.M....|</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">00000020  1a 5d 00 29 12 44 eb bb  f0 31 34 4e 31 3c 52 2d  |.].).D...14N1&lt;R-|</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">00000030  38 e2 a2 b9 51 1a c3 74  31 1a 63 0e 7a e9 f8 f4  |8...Q..t1.c.z...|</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">00000040  c5 fb 4d 4f d4 27 60 63  1d 06 67 ef 07 8f ab c0  |..MO.&#39;</span><span style="color: #9CABCA;">`</span><span style="color: #7AA89F;">c..g.....</span><span style="color: #E6C384;">|</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">00000050</span><span style="color: #D27E99;">  78 75</span><span style="color: #98BB6C;"> a1</span><span style="color: #D27E99;"> 42</span><span style="color: #98BB6C;"> 2a f2 6a b2</span><span style="color: #D27E99;">  04</span><span style="color: #98BB6C;"> eb e5 d3 3c de</span><span style="color: #D27E99;"> 71</span><span style="color: #98BB6C;"> fa</span><span style="color: #E6C384;">  |</span><span style="color: #7AA89F;">xu.B*.j.....</span><span style="color: #98BB6C;">&lt;.q.</span><span style="color: #E6C384;">|</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">00000060</span><span style="color: #98BB6C;">  7a</span><span style="color: #D27E99;"> 00</span><span style="color: #98BB6C;"> eb f6 e5</span><span style="color: #D27E99;"> 69</span><span style="color: #98BB6C;"> e3 b1  f7 7d 1a</span><span style="color: #D27E99;"> 75 00</span><span style="color: #98BB6C;"> 9c 3e</span><span style="color: #D27E99;"> 10</span><span style="color: #E6C384;">  |</span><span style="color: #7AA89F;">z....i...}.u..</span><span style="color: #98BB6C;">&gt;</span><span style="color: #7E9CD8;">.</span><span style="color: #E6C384;">|</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">00000070</span><span style="color: #98BB6C;">  6d a5 ed d1 ed e8 2b 4d  fc</span><span style="color: #D27E99;"> 19</span><span style="color: #98BB6C;"> 9d</span><span style="color: #D27E99;"> 36 66</span><span style="color: #98BB6C;"> bc</span><span style="color: #D27E99;"> 35 13</span><span style="color: #E6C384;">  |</span><span style="color: #7AA89F;">m.....+M...6f.5.</span><span style="color: #E6C384;">|</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">00000080</span><span style="color: #D27E99;">  37</span><span style="color: #98BB6C;"> ee e2</span><span style="color: #D27E99;"> 67 54 09 91</span><span style="color: #98BB6C;"> 3f  ed 7b b7 fd d1 8f 8a c3</span><span style="color: #E6C384;">  |</span><span style="color: #7AA89F;">7..gT..?.</span><span style="color: #98BB6C;">{</span><span style="color: #7E9CD8;">......</span><span style="color: #E6C384;">|</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">00000090</span><span style="color: #98BB6C;">  6f 4a f3 6a</span><span style="color: #D27E99;"> 32</span><span style="color: #98BB6C;"> 9e</span><span style="color: #D27E99;"> 72 41</span><span style="color: #98BB6C;">  cc</span><span style="color: #D27E99;"> 48</span><span style="color: #98BB6C;"> 8d</span><span style="color: #D27E99;"> 24</span><span style="color: #98BB6C;"> ee</span><span style="color: #D27E99;"> 18 29 41</span><span style="color: #E6C384;">  |</span><span style="color: #7AA89F;">oJ.j2.rA.H.$..</span><span style="color: #98BB6C;">)A</span><span style="color: #E6C384;">|</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">000000a0</span><span style="color: #98BB6C;">  d7 5f</span><span style="color: #D27E99;"> 62 47</span><span style="color: #98BB6C;"> b6</span><span style="color: #D27E99;"> 54 36</span><span style="color: #98BB6C;"> b2  2b dc</span><span style="color: #D27E99;"> 27 46</span><span style="color: #98BB6C;"> f1 de df ae</span><span style="color: #E6C384;">  |</span><span style="color: #7AA89F;">._bG.T6.+.&#39;F....|</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">000000b0  25 9e d2 aa 16 94 92 a7  3b ce b4 2c ae 00 55 c0  |%.......;..,..U.|</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">[omitted]</span></span></code></pre>
<p>Looking back at the problem description:</p>
<blockquote>
<p>All we know is the original
came from a compressed archive,</p>
</blockquote>
<p>This hints that the file is a compressed archive. The header does not really match with ZIP header which starts with
<code>50 4B 03 04</code>. Digging deeper, we can see that it has <code>00 04 cc ac 11 59</code> in the first couple of bytes. After some
researching, it was found that <code>00 04</code> is the 7z version(major and minor) and <code>cc ac 11 59</code> is the CRC of the header.
But, here <code>0d 0a</code> is carriage return. So, maybe the signature was replaced with <code>0d 0a</code>?</p>
<p>Let's do surgery on this file and replace <code>0d 0a</code> with proper 7z signature: <code>37 7A BC AF 27 1C</code>. For this, let's run the
following command:</p>
<pre class="giallo" style="color: #DCD7BA; background-color: #1F1F28;"><code data-lang="shellscript"><span class="giallo-l"><span style="color: #7E9CD8;">printf</span><span style="color: #98BB6C;"> &#39;\x37\x7A\xBC\xAF\x27\x1C&#39;</span><span style="color: #E6C384;"> |</span><span style="color: #7AA89F;"> cat</span><span style="color: #98BB6C;"> - &lt;(</span><span style="color: #7AA89F;">tail</span><span style="color: #98BB6C;"> -c +3 hidden_data.bin)</span><span style="color: #E6C384;"> &gt;</span><span style="color: #98BB6C;"> recovered.7z</span></span></code></pre>
<p>Let's slow down and see what the command actually does:</p>
<ul>
<li><code>printf</code> prints the bytes in <code>STDIN</code>. Which we pipe to <code>cat</code>.</li>
<li>The first argument <code>-</code> to cat tells it to read from <code>STDIN</code>.</li>
<li>The <code>&lt;(tail -c +3 hidden_data.bin)</code> tells <code>tail</code> to start from the 3rd byte and output the rest of the file to <code>STDIN</code> and sends it to cat.</li>
<li><code>cat</code> then first prints the content of the first argument and then the second argument to <code>STDIN</code>.</li>
<li><code>&gt; recovered.7z</code> stores the output of <code>cat</code> to <code>recovered.7z</code></li>
</ul>
<p>Running <code>file recovered.7z</code> confirms preliminary recovery:</p>
<pre class="giallo" style="color: #DCD7BA; background-color: #1F1F28;"><code data-lang="shellscript"><span class="giallo-l"><span style="color: #7AA89F;">❯</span><span style="color: #98BB6C;"> file recovered.7z</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">recovered.7z:</span><span style="color: #98BB6C;"> 7-zip archive data, version</span><span style="color: #D27E99;"> 0.4</span></span></code></pre>
<p>We now extract the archive and check for output file(s):</p>
<pre class="giallo" style="color: #DCD7BA; background-color: #1F1F28;"><code data-lang="shellscript"><span class="giallo-l"><span style="color: #7AA89F;">❯</span><span style="color: #98BB6C;"> 7z x recovered.7z</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #7AA89F;">7-Zip</span><span> [64] 17.05 </span><span style="color: #7E9CD8;">:</span><span> Copyright (</span><span style="color: #7AA89F;">c</span><span>) 1999-2021 Igor Pavlov </span><span style="color: #7E9CD8;">:</span><span> 2017-08-28</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">p7zip</span><span style="color: #98BB6C;"> Version</span><span style="color: #D27E99;"> 17.05</span><span> (locale=utf8,Utf16=on,HugeFiles=on,64</span><span style="color: #98BB6C;"> bits,12 CPUs LE</span><span>)</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #7AA89F;">Scanning</span><span style="color: #98BB6C;"> the drive for archives:</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">1</span><span style="color: #98BB6C;"> file,</span><span style="color: #D27E99;"> 1188</span><span style="color: #98BB6C;"> bytes</span><span> (2</span><span style="color: #98BB6C;"> KiB</span><span>)</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #7AA89F;">Extracting</span><span style="color: #98BB6C;"> archive: recovered.7z</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">--</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">Path</span><span style="color: #98BB6C;"> = recovered.7z</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">Type</span><span style="color: #98BB6C;"> = 7z</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">Physical</span><span style="color: #98BB6C;"> Size =</span><span style="color: #D27E99;"> 1188</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">Headers</span><span style="color: #98BB6C;"> Size =</span><span style="color: #D27E99;"> 130</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">Method</span><span style="color: #98BB6C;"> = LZMA2:12</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">Solid</span><span style="color: #98BB6C;"> = -</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">Blocks</span><span style="color: #98BB6C;"> =</span><span style="color: #D27E99;"> 1</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #7AA89F;">Everything</span><span style="color: #98BB6C;"> is Ok</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #7AA89F;">Size:</span><span style="color: #D27E99;">       1284</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">Compressed:</span><span style="color: #D27E99;"> 1188</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">❯</span><span style="color: #98BB6C;"> ls -la</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">total</span><span style="color: #D27E99;"> 2528</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">drwxr-xr-x</span><span style="color: #D27E99;">   8</span><span style="color: #98BB6C;"> mdgaziurrahmannoor  staff</span><span style="color: #D27E99;">     256</span><span style="color: #98BB6C;"> Feb</span><span style="color: #D27E99;"> 22</span><span style="color: #98BB6C;"> 08:34 .</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">drwxr-xr-x</span><span style="color: #D27E99;">  15</span><span style="color: #98BB6C;"> mdgaziurrahmannoor  staff</span><span style="color: #D27E99;">     480</span><span style="color: #98BB6C;"> Feb</span><span style="color: #D27E99;"> 20</span><span style="color: #98BB6C;"> 12:59 ..</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">-rw-r--r--</span><span style="color: #D27E99;">   1</span><span style="color: #98BB6C;"> mdgaziurrahmannoor  staff</span><span style="color: #D27E99;">     418</span><span style="color: #98BB6C;"> Feb</span><span style="color: #D27E99;"> 14</span><span style="color: #98BB6C;"> 12:08 extract_final.py</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">-rw-r--r--@</span><span style="color: #D27E99;">  1</span><span style="color: #98BB6C;"> mdgaziurrahmannoor  staff</span><span style="color: #D27E99;">    1184</span><span style="color: #98BB6C;"> Feb</span><span style="color: #D27E99;"> 22</span><span style="color: #98BB6C;"> 08:16 hidden_data.bin</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">-rw-r--r--@</span><span style="color: #D27E99;">  1</span><span style="color: #98BB6C;"> mdgaziurrahmannoor  staff</span><span style="color: #D27E99;">  636966</span><span style="color: #98BB6C;"> Feb</span><span style="color: #D27E99;"> 22</span><span style="color: #98BB6C;"> 08:01 pixel.fun</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">-rw-r--r--@</span><span style="color: #D27E99;">  1</span><span style="color: #98BB6C;"> mdgaziurrahmannoor  staff</span><span style="color: #D27E99;">  636966</span><span style="color: #98BB6C;"> Feb</span><span style="color: #D27E99;"> 14</span><span style="color: #98BB6C;"> 12:05 pixel.png</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">-rw-r--r--@</span><span style="color: #D27E99;">  1</span><span style="color: #98BB6C;"> mdgaziurrahmannoor  staff</span><span style="color: #D27E99;">    1284</span><span style="color: #98BB6C;"> Dec</span><span style="color: #D27E99;"> 17</span><span style="color: #98BB6C;"> 02:25 real_flag.png</span></span>
<span class="giallo-l"><span style="color: #7AA89F;">-rw-r--r--</span><span style="color: #D27E99;">   1</span><span style="color: #98BB6C;"> mdgaziurrahmannoor  staff</span><span style="color: #D27E99;">    1188</span><span style="color: #98BB6C;"> Feb</span><span style="color: #D27E99;"> 22</span><span style="color: #98BB6C;"> 08:33 recovered.7z</span></span></code></pre>
<p>We see a new file called <code>real_flag.png</code>. This is what it looks like:</p>
<p><img src="https://mdgaziur.github.io/blog/0xfun-ctf-pixel-rehab-writeup/./real_flag.png" alt="real_flag.png" /></p>
<p>This image contains the final flag:</p>
<pre class="giallo" style="color: #DCD7BA; background-color: #1F1F28;"><code data-lang="plain"><span class="giallo-l"><span>0xfun{FuN_PN9_f1Le_7z}</span></span></code></pre>
<p>Do not scan the QR code though, you will definitely regret it!</p>
<p>That's it for now. This is an experimental writeup I wrote. Any constructive criticism is welcome. Have a great day!</p>

        </div>
    </article>
</main>

<div id="disqus_thread"></div>
<script>
    let post_imgs = document.querySelectorAll(".post-content > p > img");
    for (let post_img of post_imgs) {
        post_img.addEventListener("click", (event) => {
            let img_src = post_img.getAttribute("src");
            let img_alt = post_img.getAttribute("alt");
            let modal = document.createElement("div");
            modal.classList.add("modal");
            modal.innerHTML = `
                <div class="img-modal-content">
                    <div class="img-modal-image">
                        <img src="${img_src}" alt="${img_alt}">
                    </div>
                    <button class="close">&times;</button>
                </div>
            `;
            document.body.appendChild(modal);
            modal.style.display = "block";
            let close_btn = modal.querySelector(".close");

            modal.onclick = (event) => {
                if (event.target.className === "img-modal-content") {
                    modal.style.display = "none";
                    document.body.removeChild(modal);
                }
            };

            close_btn.addEventListener("click", () => {
                modal.style.display = "none";
                document.body.removeChild(modal);
            });
        });
    }
</script>
<script>
    /**
     *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT
     *  THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR
     *  PLATFORM OR CMS.
     *
     *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT:
     *  https://disqus.com/admin/universalcode/#configuration-variables
     */
    /*
    var disqus_config = function () {
        // Replace PAGE_URL with your page's canonical URL variable
        this.page.url = PAGE_URL;

        // Replace PAGE_IDENTIFIER with your page's unique identifier variable
        this.page.identifier = PAGE_IDENTIFIER;
    };
    */

    (function() {  // REQUIRED CONFIGURATION VARIABLE: EDIT THE SHORTNAME BELOW
        var d = document, s = d.createElement('script');

        // IMPORTANT: Replace EXAMPLE with your forum shortname!
        s.src = 'https://mdgaziur-github-io-blog.disqus.com/embed.js';

        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>
    Please enable JavaScript to view the
    <a href="https://disqus.com/?ref_noscript" rel="nofollow">
        comments powered by Disqus.
    </a>
</noscript>

    </div>
</body>
</html>